/*!
 * gulp-nunjucks-sass-template
 * A Gulp 4 template including SCSS, Nunjucks, JS and more
 *
 * Url: https://github.com/DefaultSimon
 * Author: Simon GoriÄar
 * Copyright 2019-2020. MIT licensed.
 */
document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".header_tags .tag");let t,o,n=[];function i(){if(console.log(window.innerWidth>=1024,window.innerWidth>window.innerHeight),document.querySelector(".compilation")){let e,t,o,n=document.querySelectorAll(".compilation .item");window.innerWidth<1024&&window.innerWidth<window.innerHeight?(e=n[0].querySelector(".item_image").offsetWidth,t=e/2*3,Array.prototype.forEach.call(n,function(e){e.querySelector(".item_image").style.height=t+"px"})):(e=n[0].offsetWidth,n[0].classList.contains("wide")?t=(e-40)/151*106:(t=(e-40)/53*76,console.log(e)),Array.prototype.forEach.call(n,function(e){let n=e.querySelector(".item_image");o=e.querySelector(".item_tags"),n.style.height=t+"px",o.style.top=t+"px"}))}function i(e,t){t.onclick=(()=>new function(){e.classList.toggle("open")})}if(document.querySelector("#copyLink")&&document.querySelector("#copyLink").addEventListener("click",()=>{let e=document.createElement("input"),t=window.location.href;document.body.appendChild(e),e.value=t,e.select(),document.execCommand("copy"),document.body.removeChild(e)}),document.querySelector(".header_tags")){let i=document.querySelector(".header_tags"),c=document.querySelector(".header_tags .tag_list"),l=document.querySelector(".header_tags .tag-wrapper"),s=0,a=i.offsetWidth,d=l.offsetWidth,u=0,f=Array.prototype.slice.call(e),y=n.slice();function r(e){if(u=d-24,document.querySelector(".header_tags .tag.current"))do{u+=y[e],e++}while(u<=a-d-24-26&&e<f.length);else do{u+=y[e],e++}while(u<=a-d-24&&e<f.length);return e}s=r(s);let g=document.querySelectorAll(".header_tags .tag");if(t){if(o()>s){let e=y[o()];f.splice(o(),1),y.splice(o(),1);let n=s-1;f.splice(n,0,t),y.splice(n,0,e)}s=r(s=0)}Array.prototype.forEach.call(g,function(e){e.remove()});for(let e=0;e<s;e++)l.before(f[e]);for(let e=s;e<f.length;e++)c.append(f[e]);i.style.flexWrap="nowrap"}if(document.querySelector(".header_tags")){const e=document.querySelector(".header_menu"),t=e.querySelector(".menu"),o=e.querySelector(".btn-icon");new i(t,o);const n=document.querySelector(".header_language"),r=n.querySelector(".language"),c=n.querySelector(".btn-icon");new i(r,c);const l=document.querySelector(".header_notification"),s=l.querySelector(".notification"),a=l.querySelector(".btn-icon");new i(s,a);const d=document.querySelector(".header_tags .tag-wrapper"),u=d.querySelector(".tag_list"),f=d.querySelector(".tag-button");new i(u,f),document.onclick=(e=>{let n=e.target,i=n===t||t.contains(n),l=n===o,d=t.classList.contains("open"),y=n===r||r.contains(n),g=n===c,p=r.classList.contains("open"),h=n===s||s.contains(n),m=n===a,w=s.classList.contains("open"),q=n===u||u.contains(n),S=n===f,_=u.classList.contains("open");i||l||!d||t.classList.toggle("open"),y||g||!p||r.classList.toggle("open"),h||m||!w||s.classList.toggle("open"),q||S||!_||u.classList.toggle("open")})}let c=document.querySelector(".article"),l=document.querySelector(".article_image");if(c)if(window.innerWidth>window.innerHeight){let e,t,o=document.querySelector(".article_image-picture"),n=document.querySelector(".article_image-caption");console.log(c.offsetWidth/2,c.querySelector(".wrapper").offsetWidth,l.offsetHeight+80>window.innerHeight),c.offsetWidth/2<c.querySelector(".wrapper").offsetWidth&&c.offsetWidth<1100?(l.offsetHeight+80>window.innerHeight?(o.style.height=l.offsetHeight-n.offsetHeight+"px",t=(e=o.offsetHeight)/153*102):e=(t=c.offsetWidth/2-120)/102*153,l.style.width=t+"px",document.querySelector(".article").style.paddingLeft=t+40+"px"):(l.offsetHeight+80>window.innerHeight&&(o.style.height=l.offsetHeight-n.offsetHeight+"px"),t=(e=o.offsetHeight)/153*102,l.style.width=t+"px",document.querySelector(".article").style.paddingLeft=t+40+"px");let i=0,r=0;document.onscroll=function(){if(document.querySelector(".article")){let e,t=document.querySelector("section.article").offsetHeight,o=document.querySelector(".header").offsetHeight,n=document.querySelector(".banners_container"),c=n.offsetHeight,s=document.querySelector(".banners_wrapper").offsetHeight,a=document.querySelector(".content").offsetHeight,d=pageYOffset-i;c-s>0&&(r+=e=d/(a/(c-s+48)),n.style.transform="translateY("+-1*r+"px)"),pageYOffset>40&&pageYOffset<t+o-l.offsetHeight-100?(l.style.position="fixed",l.style.top="40px",l.style.bottom="auto",l.style.width=l.offsetWidth+"px"):pageYOffset>40&&pageYOffset>t+o-l.offsetHeight-100?(l.style.position="absolute",l.style.top="auto",l.style.bottom="80px",l.style.width=l.offsetWidth+"px"):(l.style.position="absolute",l.style.top="40px",l.style.bottom="auto",l.style.width=l.offsetWidth+"px"),i=pageYOffset}}}else document.querySelector(".article").style.paddingLeft="16px"}document.querySelector(".header_tags")&&(Array.prototype.forEach.call(e,function(e){n.push(e.offsetWidth+12)}),t=document.querySelector(".header_tags .tag.current"),o=function(){if(null!==t)return Array.prototype.slice.call(e).indexOf(t)}),new i,window.onresize=i});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMuanMiXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwidGFnc0xpc3REZWZhdWx0IiwicXVlcnlTZWxlY3RvckFsbCIsImN1cnJlbnRUYWciLCJjdXJyZW50VGFnSW5kZXgiLCJ0YWdzV2lkdGhMaXN0RGVmYXVsdCIsIlN0YXJ0U2NyaXB0cyIsImNvbnNvbGUiLCJsb2ciLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJxdWVyeVNlbGVjdG9yIiwiaXRlbVdpZHRoIiwiaW1hZ2VIZWlnaHQiLCJpdGVtVGFncyIsIml0ZW1zT25QYWdlIiwib2Zmc2V0V2lkdGgiLCJBcnJheSIsInByb3RvdHlwZSIsImZvckVhY2giLCJjYWxsIiwiZWxlbSIsInN0eWxlIiwiaGVpZ2h0IiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJpbWFnZSIsInRvcCIsIlRvZ2dsZUJsb2NrIiwiYmxvY2siLCJidXR0b24iLCJvbmNsaWNrIiwidG9nZ2xlIiwiZHVtbXkiLCJjcmVhdGVFbGVtZW50IiwidGV4dCIsImxvY2F0aW9uIiwiaHJlZiIsImJvZHkiLCJhcHBlbmRDaGlsZCIsInZhbHVlIiwic2VsZWN0IiwiZXhlY0NvbW1hbmQiLCJyZW1vdmVDaGlsZCIsInRhZ05hdiIsInRhZ01vcmVMaXN0IiwidGFnTW9yZUJ1dHRvbiIsImkiLCJ0YWdOYXZXaWR0aCIsInRhZ01vcmVCdXR0b25XaWR0aCIsInRhZ3NWaXNpYmxlV2lkdGgiLCJ0YWdzTGlzdCIsInNsaWNlIiwidGFnc1dpZHRoTGlzdCIsIkZpbmRUYWdzVmlzaWJsZVdpZHRoIiwiaW5kZXgiLCJsZW5ndGgiLCJhbGxOYXZUYWdzIiwiY3VycmVudFRhZ1dpZHRoIiwic3BsaWNlIiwiayIsInJlbW92ZSIsImIiLCJiZWZvcmUiLCJsIiwiYXBwZW5kIiwiZmxleFdyYXAiLCJtZW51V3JhcHBlciIsIm1lbnUiLCJtZW51QnV0dG9uIiwibGFuZ3VhZ2VXcmFwcGVyIiwibGFuZ3VhZ2UiLCJsYW5ndWFnZUJ1dHRvbiIsIm5vdGlmaWNhdGlvbldyYXBwZXIiLCJub3RpZmljYXRpb24iLCJub3RpZmljYXRpb25CdXR0b24iLCJuYXZXcmFwcGVyIiwibmF2TGlzdCIsIm5hdkJ1dHRvbiIsImUiLCJ0YXJnZXQiLCJpdHNNZW51IiwiaXRzTWVudUJ1dHRvbiIsIm1lbnVJc0FjdGl2ZSIsIml0c0xhbmd1YWdlIiwiaXRzTGFuZ3VhZ2VCdXR0b24iLCJsYW5ndWFnZUlzQWN0aXZlIiwiaXRzTm90aWZpY2F0aW9uIiwiaXRzTm90aWZpY2F0aW9uQnV0dG9uIiwibm90aWZpY2F0aW9uSXNBY3RpdmUiLCJpdHNMaXN0IiwiaXRzTGlzdEJ1dHRvbiIsImxpc3RJc0FjdGl2ZSIsImFydGljbGUiLCJhcnRpY2xlSW1hZ2UiLCJwaWN0dXJlSGVpZ2h0IiwicGljdHVyZVdpZHRoIiwicGljdHVyZSIsImNhcHRpb24iLCJvZmZzZXRIZWlnaHQiLCJ3aWR0aCIsInBhZGRpbmdMZWZ0IiwiY3VycmVudFBhZ2VZUG9zaXRpb24iLCJiYW5uZXJzU2Nyb2xsIiwib25zY3JvbGwiLCJiYW5uZXJzU2Nyb2xsTmV3IiwiYXJ0aWNsZUhlaWdodCIsImhlYWRlckhlaWdodCIsImJhbm5lcnNDb250YWluZXIiLCJiYW5uZXJzQ29udGFpbmVySGVpZ2h0IiwiYmFubmVyc1dyYXBwZXJIZWlnaHQiLCJjb250ZW50SGVpZ2h0Iiwic2Nyb2xsRGlmZmVyZW5jZSIsInBhZ2VZT2Zmc2V0IiwidHJhbnNmb3JtIiwicG9zaXRpb24iLCJib3R0b20iLCJwdXNoIiwiaW5kZXhPZiIsIm9ucmVzaXplIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUNBQSxTQUFBQyxpQkFBQSxtQkFBQSxXQUNBLE1BQUFDLEVBQUFGLFNBQUFHLGlCQUFBLHFCQUNBLElBQUFDLEVBQUFDLEVBQUFDLEtBS0EsU0FBQUMsSUFHQSxHQUZBQyxRQUFBQyxJQUFBQyxPQUFBQyxZQUFBLEtBQUFELE9BQUFDLFdBQUFELE9BQUFFLGFBRUFaLFNBQUFhLGNBQUEs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QUFBLE9BQUFELEVBQ0EsT0FBQWUsTUFBQUMsVUFBQWtDLE1BQUFoQyxLQUFBcEIsR0FBQXNILFFBQUFwSCxLQWlPQSxJQUFBRyxFQUVBRyxPQUFBK0csU0FBQWxIIiwiZmlsZSI6InNjcmlwdHMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8g0JDQvdCw0LvQvtCzICQoZG9jdW1lbnQpLnJlYWR5KClcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHtcbiAgY29uc3QgdGFnc0xpc3REZWZhdWx0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmhlYWRlcl90YWdzIC50YWcnKTtcbiAgbGV0IHRhZ3NXaWR0aExpc3REZWZhdWx0ID0gW10sIGN1cnJlbnRUYWcsIGN1cnJlbnRUYWdJbmRleDtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfdGFncycpKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbCh0YWdzTGlzdERlZmF1bHQsIGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgIHRhZ3NXaWR0aExpc3REZWZhdWx0LnB1c2goIGVsZW0ub2Zmc2V0V2lkdGggKyAxMiApO1xuICAgIH0pO1xuICAgIGN1cnJlbnRUYWcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX3RhZ3MgLnRhZy5jdXJyZW50Jyk7XG4gICAgY3VycmVudFRhZ0luZGV4ID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoY3VycmVudFRhZyAhPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGFnc0xpc3REZWZhdWx0KS5pbmRleE9mKGN1cnJlbnRUYWcpO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBmdW5jdGlvbiBTdGFydFNjcmlwdHMoKSB7XG4gICAgY29uc29sZS5sb2coKHdpbmRvdy5pbm5lcldpZHRoID49IDEwMjQpLCAod2luZG93LmlubmVyV2lkdGggPiB3aW5kb3cuaW5uZXJIZWlnaHQpKTtcblxuICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29tcGlsYXRpb24nKSkge1xuICAgICAgbGV0IGl0ZW1zT25QYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbXBpbGF0aW9uIC5pdGVtJyksIGl0ZW1XaWR0aCwgaW1hZ2VIZWlnaHQsIGl0ZW1UYWdzO1xuICAgICAgaWYgKCh3aW5kb3cuaW5uZXJXaWR0aCA8IDEwMjQpICYmICh3aW5kb3cuaW5uZXJXaWR0aCA8IHdpbmRvdy5pbm5lckhlaWdodCkpIHsgLy9wb3J0cmFpdFxuICAgICAgICBpdGVtV2lkdGggPSBpdGVtc09uUGFnZVswXS5xdWVyeVNlbGVjdG9yKCcuaXRlbV9pbWFnZScpLm9mZnNldFdpZHRoO1xuICAgICAgICBpbWFnZUhlaWdodCA9IGl0ZW1XaWR0aCAvIDIgKiAzO1xuICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGl0ZW1zT25QYWdlLCBmdW5jdGlvbihlbGVtKXtcbiAgICAgICAgICBsZXQgaW1hZ2UgPSBlbGVtLnF1ZXJ5U2VsZWN0b3IoJy5pdGVtX2ltYWdlJyk7XG4gICAgICAgICAgaW1hZ2Uuc3R5bGUuaGVpZ2h0ID0gaW1hZ2VIZWlnaHQgKyAncHgnO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGl0ZW1XaWR0aCA9IGl0ZW1zT25QYWdlWzBdLm9mZnNldFdpZHRoO1xuICAgICAgICBpZiAoaXRlbXNPblBhZ2VbMF0uY2xhc3NMaXN0LmNvbnRhaW5zKCd3aWRlJykpIHtcbiAgICAgICAgICBpbWFnZUhlaWdodCA9IChpdGVtV2lkdGggLSA0MCkgLyAxNTEgKiAxMDY7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaW1hZ2VIZWlnaHQgPSAoaXRlbVdpZHRoIC0gNDApIC8gNTMgKiA3NjtcbiAgICAgICAgICBjb25zb2xlLmxvZyhpdGVtV2lkdGgpO1xuICAgICAgICB9XG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoaXRlbXNPblBhZ2UsIGZ1bmN0aW9uKGVsZW0pe1xuICAgICAgICAgIGxldCBpbWFnZSA9IGVsZW0ucXVlcnlTZWxlY3RvcignLml0ZW1faW1hZ2UnKTtcbiAgICAgICAgICBpdGVtVGFncyA9IGVsZW0ucXVlcnlTZWxlY3RvcignLml0ZW1fdGFncycpO1xuICAgICAgICAgIGltYWdlLnN0eWxlLmhlaWdodCA9IGltYWdlSGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICBpdGVtVGFncy5zdHlsZS50b3AgPSBpbWFnZUhlaWdodCArICdweCc7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY29weUxpbmsnKSkge1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NvcHlMaW5rJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGxldCBkdW1teSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JyksXG4gICAgICAgICAgICB0ZXh0ID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG5cbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkdW1teSk7XG4gICAgICAgIGR1bW15LnZhbHVlID0gdGV4dDtcbiAgICAgICAgZHVtbXkuc2VsZWN0KCk7XG4gICAgICAgIGRvY3VtZW50LmV4ZWNDb21tYW5kKCdjb3B5Jyk7XG4gICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZHVtbXkpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gVG9nZ2xlQmxvY2soYmxvY2ssIGJ1dHRvbikge1xuICAgICAgbGV0IFRvZ2dsZU1lbnUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgYmxvY2suY2xhc3NMaXN0LnRvZ2dsZSgnb3BlbicpO1xuICAgICAgfTtcbiAgICAgIGJ1dHRvbi5vbmNsaWNrID0gKCkgPT4gKG5ldyBUb2dnbGVNZW51KCkpO1xuICAgIH1cblxuICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX3RhZ3MnKSkge1xuICAgICAgbGV0IHRhZ05hdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfdGFncycpLFxuICAgICAgICAgIHRhZ01vcmVMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl90YWdzIC50YWdfbGlzdCcpLFxuICAgICAgICAgIHRhZ01vcmVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX3RhZ3MgLnRhZy13cmFwcGVyJyksXG4gICAgICAgICAgaSA9IDAsXG4gICAgICAgICAgdGFnTmF2V2lkdGggPSB0YWdOYXYub2Zmc2V0V2lkdGgsXG4gICAgICAgICAgdGFnTW9yZUJ1dHRvbldpZHRoID0gdGFnTW9yZUJ1dHRvbi5vZmZzZXRXaWR0aCxcbiAgICAgICAgICB0YWdzVmlzaWJsZVdpZHRoID0gMCxcbiAgICAgICAgICB0YWdzTGlzdCA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRhZ3NMaXN0RGVmYXVsdCksXG4gICAgICAgICAgdGFnc1dpZHRoTGlzdCA9IHRhZ3NXaWR0aExpc3REZWZhdWx0LnNsaWNlKCk7XG4gICAgICBmdW5jdGlvbiBGaW5kVGFnc1Zpc2libGVXaWR0aChpbmRleCkge1xuICAgICAgICB0YWdzVmlzaWJsZVdpZHRoID0gdGFnTW9yZUJ1dHRvbldpZHRoIC0gMjQ7XG4gICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX3RhZ3MgLnRhZy5jdXJyZW50JykpIHtcbiAgICAgICAgICBkbyB7XG4gICAgICAgICAgICB0YWdzVmlzaWJsZVdpZHRoID0gdGFnc1Zpc2libGVXaWR0aCArIHRhZ3NXaWR0aExpc3RbaW5kZXhdO1xuICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICB9IHdoaWxlICgodGFnc1Zpc2libGVXaWR0aCA8PSAodGFnTmF2V2lkdGggLSB0YWdNb3JlQnV0dG9uV2lkdGggLSAyNCAtIDI2KSkgJiYgKGluZGV4IDwgdGFnc0xpc3QubGVuZ3RoKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZG8ge1xuICAgICAgICAgICAgdGFnc1Zpc2libGVXaWR0aCA9IHRhZ3NWaXNpYmxlV2lkdGggKyB0YWdzV2lkdGhMaXN0W2luZGV4XTtcbiAgICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgfSB3aGlsZSAoKHRhZ3NWaXNpYmxlV2lkdGggPD0gKHRhZ05hdldpZHRoIC0gdGFnTW9yZUJ1dHRvbldpZHRoIC0gMjQpKSAmJiAoaW5kZXggPCB0YWdzTGlzdC5sZW5ndGgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICB9XG4gICAgICBpID0gRmluZFRhZ3NWaXNpYmxlV2lkdGgoaSk7XG4gICAgICBsZXQgYWxsTmF2VGFncyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5oZWFkZXJfdGFncyAudGFnJyk7XG4gICAgICBpZiAoY3VycmVudFRhZykge1xuICAgICAgICBpZiAoY3VycmVudFRhZ0luZGV4KCkgPiBpKSB7XG4gICAgICAgICAgbGV0IGN1cnJlbnRUYWdXaWR0aCA9IHRhZ3NXaWR0aExpc3RbY3VycmVudFRhZ0luZGV4KCldO1xuICAgICAgICAgIHRhZ3NMaXN0LnNwbGljZShjdXJyZW50VGFnSW5kZXgoKSwgMSk7XG4gICAgICAgICAgdGFnc1dpZHRoTGlzdC5zcGxpY2UoY3VycmVudFRhZ0luZGV4KCksIDEpO1xuICAgICAgICAgIGxldCBrID0gaSAtIDE7XG4gICAgICAgICAgdGFnc0xpc3Quc3BsaWNlKGssIDAsIGN1cnJlbnRUYWcpO1xuICAgICAgICAgIHRhZ3NXaWR0aExpc3Quc3BsaWNlKGssIDAsIGN1cnJlbnRUYWdXaWR0aCk7XG4gICAgICAgIH1cbiAgICAgICAgaSA9IDA7XG4gICAgICAgIGkgPSBGaW5kVGFnc1Zpc2libGVXaWR0aChpKTtcbiAgICAgIH1cbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoYWxsTmF2VGFncywgZnVuY3Rpb24gKGVsZW0pIHtcbiAgICAgICAgZWxlbS5yZW1vdmUoKTtcbiAgICAgIH0pO1xuICAgICAgZm9yIChsZXQgYiA9IDA7IGIgPCBpOyBiKyspIHtcbiAgICAgICAgdGFnTW9yZUJ1dHRvbi5iZWZvcmUodGFnc0xpc3RbYl0pO1xuICAgICAgfVxuICAgICAgZm9yIChsZXQgbCA9IGk7IGwgPCB0YWdzTGlzdC5sZW5ndGg7IGwrKykge1xuICAgICAgICB0YWdNb3JlTGlzdC5hcHBlbmQodGFnc0xpc3RbbF0pO1xuICAgICAgfVxuICAgICAgdGFnTmF2LnN0eWxlLmZsZXhXcmFwID0gJ25vd3JhcCc7XG4gICAgfVxuXG4gICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfdGFncycpKSB7XG4gICAgICBjb25zdCBtZW51V3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfbWVudScpLFxuICAgICAgICAgICAgbWVudSA9IG1lbnVXcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy5tZW51JyksXG4gICAgICAgICAgICBtZW51QnV0dG9uID0gbWVudVdyYXBwZXIucXVlcnlTZWxlY3RvcignLmJ0bi1pY29uJyk7XG4gICAgICBuZXcgVG9nZ2xlQmxvY2sobWVudSwgbWVudUJ1dHRvbik7XG4gICAgICBjb25zdCBsYW5ndWFnZVdyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX2xhbmd1YWdlJyksXG4gICAgICAgICAgICBsYW5ndWFnZSA9IGxhbmd1YWdlV3JhcHBlci5xdWVyeVNlbGVjdG9yKCcubGFuZ3VhZ2UnKSxcbiAgICAgICAgICAgIGxhbmd1YWdlQnV0dG9uID0gbGFuZ3VhZ2VXcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy5idG4taWNvbicpO1xuICAgICAgbmV3IFRvZ2dsZUJsb2NrKGxhbmd1YWdlLCBsYW5ndWFnZUJ1dHRvbik7XG4gICAgICBjb25zdCBub3RpZmljYXRpb25XcmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9ub3RpZmljYXRpb24nKSxcbiAgICAgICAgICAgIG5vdGlmaWNhdGlvbiA9IG5vdGlmaWNhdGlvbldyYXBwZXIucXVlcnlTZWxlY3RvcignLm5vdGlmaWNhdGlvbicpLFxuICAgICAgICAgICAgbm90aWZpY2F0aW9uQnV0dG9uID0gbm90aWZpY2F0aW9uV3JhcHBlci5xdWVyeVNlbGVjdG9yKCcuYnRuLWljb24nKTtcbiAgICAgIG5ldyBUb2dnbGVCbG9jayhub3RpZmljYXRpb24sIG5vdGlmaWNhdGlvbkJ1dHRvbik7XG4gICAgICBjb25zdCBuYXZXcmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl90YWdzIC50YWctd3JhcHBlcicpLFxuICAgICAgICBuYXZMaXN0ID0gbmF2V3JhcHBlci5xdWVyeVNlbGVjdG9yKCcudGFnX2xpc3QnKSxcbiAgICAgICAgbmF2QnV0dG9uID0gbmF2V3JhcHBlci5xdWVyeVNlbGVjdG9yKCcudGFnLWJ1dHRvbicpO1xuICAgICAgbmV3IFRvZ2dsZUJsb2NrKG5hdkxpc3QsIG5hdkJ1dHRvbik7XG5cbiAgICAgIGRvY3VtZW50Lm9uY2xpY2sgPSAoZSkgPT4ge1xuICAgICAgICBsZXQgdGFyZ2V0ID0gZS50YXJnZXQsXG4gICAgICAgICAgaXRzTWVudSA9IHRhcmdldCA9PT0gbWVudSB8fCBtZW51LmNvbnRhaW5zKHRhcmdldCksXG4gICAgICAgICAgaXRzTWVudUJ1dHRvbiA9IHRhcmdldCA9PT0gbWVudUJ1dHRvbixcbiAgICAgICAgICBtZW51SXNBY3RpdmUgPSBtZW51LmNsYXNzTGlzdC5jb250YWlucygnb3BlbicpLFxuICAgICAgICAgIGl0c0xhbmd1YWdlID0gdGFyZ2V0ID09PSBsYW5ndWFnZSB8fCBsYW5ndWFnZS5jb250YWlucyh0YXJnZXQpLFxuICAgICAgICAgIGl0c0xhbmd1YWdlQnV0dG9uID0gdGFyZ2V0ID09PSBsYW5ndWFnZUJ1dHRvbixcbiAgICAgICAgICBsYW5ndWFnZUlzQWN0aXZlID0gbGFuZ3VhZ2UuY2xhc3NMaXN0LmNvbnRhaW5zKCdvcGVuJyksXG4gICAgICAgICAgaXRzTm90aWZpY2F0aW9uID0gdGFyZ2V0ID09PSBub3RpZmljYXRpb24gfHwgbm90aWZpY2F0aW9uLmNvbnRhaW5zKHRhcmdldCksXG4gICAgICAgICAgaXRzTm90aWZpY2F0aW9uQnV0dG9uID0gdGFyZ2V0ID09PSBub3RpZmljYXRpb25CdXR0b24sXG4gICAgICAgICAgbm90aWZpY2F0aW9uSXNBY3RpdmUgPSBub3RpZmljYXRpb24uY2xhc3NMaXN0LmNvbnRhaW5zKCdvcGVuJyksXG4gICAgICAgICAgaXRzTGlzdCA9IHRhcmdldCA9PT0gbmF2TGlzdCB8fCBuYXZMaXN0LmNvbnRhaW5zKHRhcmdldCksXG4gICAgICAgICAgaXRzTGlzdEJ1dHRvbiA9IHRhcmdldCA9PT0gbmF2QnV0dG9uLFxuICAgICAgICAgIGxpc3RJc0FjdGl2ZSA9IG5hdkxpc3QuY2xhc3NMaXN0LmNvbnRhaW5zKCdvcGVuJyk7XG5cbiAgICAgICAgaWYgKCFpdHNNZW51ICYmICFpdHNNZW51QnV0dG9uICYmIG1lbnVJc0FjdGl2ZSkge1xuICAgICAgICAgIG1lbnUuY2xhc3NMaXN0LnRvZ2dsZSgnb3BlbicpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXRzTGFuZ3VhZ2UgJiYgIWl0c0xhbmd1YWdlQnV0dG9uICYmIGxhbmd1YWdlSXNBY3RpdmUpIHtcbiAgICAgICAgICBsYW5ndWFnZS5jbGFzc0xpc3QudG9nZ2xlKCdvcGVuJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpdHNOb3RpZmljYXRpb24gJiYgIWl0c05vdGlmaWNhdGlvbkJ1dHRvbiAmJiBub3RpZmljYXRpb25Jc0FjdGl2ZSkge1xuICAgICAgICAgIG5vdGlmaWNhdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCdvcGVuJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpdHNMaXN0ICYmICFpdHNMaXN0QnV0dG9uICYmIGxpc3RJc0FjdGl2ZSkge1xuICAgICAgICAgIG5hdkxpc3QuY2xhc3NMaXN0LnRvZ2dsZSgnb3BlbicpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cblxuICAgIGxldCBhcnRpY2xlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFydGljbGUnKSxcbiAgICAgICAgYXJ0aWNsZUltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFydGljbGVfaW1hZ2UnKTtcbiAgICBpZiAoYXJ0aWNsZSkge1xuICAgICAgaWYgKCh3aW5kb3cuaW5uZXJXaWR0aCA+IHdpbmRvdy5pbm5lckhlaWdodCkpIHtcbiAgICAgICAgbGV0IHBpY3R1cmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXJ0aWNsZV9pbWFnZS1waWN0dXJlJyksXG4gICAgICAgICAgY2FwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcnRpY2xlX2ltYWdlLWNhcHRpb24nKSxcbiAgICAgICAgICBwaWN0dXJlSGVpZ2h0LCBwaWN0dXJlV2lkdGg7XG4gICAgICAgIGNvbnNvbGUubG9nKGFydGljbGUub2Zmc2V0V2lkdGggLyAyLCBhcnRpY2xlLnF1ZXJ5U2VsZWN0b3IoJy53cmFwcGVyJykub2Zmc2V0V2lkdGgsIChhcnRpY2xlSW1hZ2Uub2Zmc2V0SGVpZ2h0ICsgODApID4gd2luZG93LmlubmVySGVpZ2h0KTtcbiAgICAgICAgaWYgKCgoYXJ0aWNsZS5vZmZzZXRXaWR0aCAvIDIpIDwgKGFydGljbGUucXVlcnlTZWxlY3RvcignLndyYXBwZXInKS5vZmZzZXRXaWR0aCkpICYmIChhcnRpY2xlLm9mZnNldFdpZHRoIDwgMTEwMCkpIHtcbiAgICAgICAgICBpZiAoKGFydGljbGVJbWFnZS5vZmZzZXRIZWlnaHQgKyA4MCkgPiB3aW5kb3cuaW5uZXJIZWlnaHQpIHtcbiAgICAgICAgICAgIHBpY3R1cmUuc3R5bGUuaGVpZ2h0ID0gKGFydGljbGVJbWFnZS5vZmZzZXRIZWlnaHQgLSBjYXB0aW9uLm9mZnNldEhlaWdodCkgKyAncHgnO1xuICAgICAgICAgICAgcGljdHVyZUhlaWdodCA9IHBpY3R1cmUub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgICAgcGljdHVyZVdpZHRoID0gcGljdHVyZUhlaWdodCAvIDE1MyAqIDEwMjtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGljdHVyZVdpZHRoID0gKGFydGljbGUub2Zmc2V0V2lkdGggLyAyKSAtIDEyMDtcbiAgICAgICAgICAgIHBpY3R1cmVIZWlnaHQgPSBwaWN0dXJlV2lkdGggLyAxMDIgKiAxNTM7XG4gICAgICAgICAgfVxuICAgICAgICAgIGFydGljbGVJbWFnZS5zdHlsZS53aWR0aCA9IHBpY3R1cmVXaWR0aCArICdweCc7XG4gICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFydGljbGUnKS5zdHlsZS5wYWRkaW5nTGVmdCA9IHBpY3R1cmVXaWR0aCArIDQwICsgJ3B4JztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoKGFydGljbGVJbWFnZS5vZmZzZXRIZWlnaHQgKyA4MCkgPiB3aW5kb3cuaW5uZXJIZWlnaHQpIHtcbiAgICAgICAgICAgIHBpY3R1cmUuc3R5bGUuaGVpZ2h0ID0gKGFydGljbGVJbWFnZS5vZmZzZXRIZWlnaHQgLSBjYXB0aW9uLm9mZnNldEhlaWdodCkgKyAncHgnO1xuICAgICAgICAgIH1cbiAgICAgICAgICBwaWN0dXJlSGVpZ2h0ID0gcGljdHVyZS5vZmZzZXRIZWlnaHQ7XG4gICAgICAgICAgcGljdHVyZVdpZHRoID0gcGljdHVyZUhlaWdodCAvIDE1MyAqIDEwMjtcbiAgICAgICAgICBhcnRpY2xlSW1hZ2Uuc3R5bGUud2lkdGggPSBwaWN0dXJlV2lkdGggKyAncHgnO1xuICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcnRpY2xlJykuc3R5bGUucGFkZGluZ0xlZnQgPSBwaWN0dXJlV2lkdGggKyA0MCArICdweCc7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGN1cnJlbnRQYWdlWVBvc2l0aW9uID0gMCwgYmFubmVyc1Njcm9sbCA9IDA7XG4gICAgICAgIGRvY3VtZW50Lm9uc2Nyb2xsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXJ0aWNsZScpKSB7XG4gICAgICAgICAgICBsZXQgYXJ0aWNsZUhlaWdodCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3NlY3Rpb24uYXJ0aWNsZScpLm9mZnNldEhlaWdodCxcbiAgICAgICAgICAgICAgaGVhZGVySGVpZ2h0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcicpLm9mZnNldEhlaWdodDtcblxuICAgICAgICAgICAgbGV0IGJhbm5lcnNDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYmFubmVyc19jb250YWluZXInKSxcbiAgICAgICAgICAgICAgYmFubmVyc0NvbnRhaW5lckhlaWdodCA9IGJhbm5lcnNDb250YWluZXIub2Zmc2V0SGVpZ2h0LFxuICAgICAgICAgICAgICBiYW5uZXJzV3JhcHBlckhlaWdodCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5iYW5uZXJzX3dyYXBwZXInKS5vZmZzZXRIZWlnaHQsXG4gICAgICAgICAgICAgIGNvbnRlbnRIZWlnaHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpLm9mZnNldEhlaWdodCxcbiAgICAgICAgICAgICAgYmxvY2tzRGlmZmVyZW5jZSA9IChjb250ZW50SGVpZ2h0KSAvIChiYW5uZXJzQ29udGFpbmVySGVpZ2h0IC0gYmFubmVyc1dyYXBwZXJIZWlnaHQgKyA0OCksXG4gICAgICAgICAgICAgIHNjcm9sbERpZmZlcmVuY2UgPSBwYWdlWU9mZnNldCAtIGN1cnJlbnRQYWdlWVBvc2l0aW9uLCBiYW5uZXJzU2Nyb2xsTmV3O1xuICAgICAgICAgICAgaWYgKChiYW5uZXJzQ29udGFpbmVySGVpZ2h0IC0gYmFubmVyc1dyYXBwZXJIZWlnaHQpID4gMCkge1xuICAgICAgICAgICAgICBiYW5uZXJzU2Nyb2xsTmV3ID0gc2Nyb2xsRGlmZmVyZW5jZSAvIGJsb2Nrc0RpZmZlcmVuY2U7XG4gICAgICAgICAgICAgIGJhbm5lcnNTY3JvbGwgPSBiYW5uZXJzU2Nyb2xsICsgYmFubmVyc1Njcm9sbE5ldztcbiAgICAgICAgICAgICAgYmFubmVyc0NvbnRhaW5lci5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWSgnICsgKGJhbm5lcnNTY3JvbGwgKiAtMSkgKyAncHgpJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKChwYWdlWU9mZnNldCA+IDQwKSAmJiAocGFnZVlPZmZzZXQgPCAoYXJ0aWNsZUhlaWdodCArIGhlYWRlckhlaWdodCAtIGFydGljbGVJbWFnZS5vZmZzZXRIZWlnaHQgLSAxMDApKSkge1xuICAgICAgICAgICAgICBhcnRpY2xlSW1hZ2Uuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnO1xuICAgICAgICAgICAgICBhcnRpY2xlSW1hZ2Uuc3R5bGUudG9wID0gJzQwcHgnO1xuICAgICAgICAgICAgICBhcnRpY2xlSW1hZ2Uuc3R5bGUuYm90dG9tID0gJ2F1dG8nO1xuICAgICAgICAgICAgICBhcnRpY2xlSW1hZ2Uuc3R5bGUud2lkdGggPSBhcnRpY2xlSW1hZ2Uub2Zmc2V0V2lkdGggKyAncHgnO1xuICAgICAgICAgICAgfSBlbHNlIGlmICgocGFnZVlPZmZzZXQgPiA0MCkgJiYgKHBhZ2VZT2Zmc2V0ID4gKGFydGljbGVIZWlnaHQgKyBoZWFkZXJIZWlnaHQgLSBhcnRpY2xlSW1hZ2Uub2Zmc2V0SGVpZ2h0IC0gMTAwKSkpIHtcbiAgICAgICAgICAgICAgYXJ0aWNsZUltYWdlLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICAgICAgICAgICAgYXJ0aWNsZUltYWdlLnN0eWxlLnRvcCA9ICdhdXRvJztcbiAgICAgICAgICAgICAgYXJ0aWNsZUltYWdlLnN0eWxlLmJvdHRvbSA9ICc4MHB4JztcbiAgICAgICAgICAgICAgYXJ0aWNsZUltYWdlLnN0eWxlLndpZHRoID0gYXJ0aWNsZUltYWdlLm9mZnNldFdpZHRoICsgJ3B4JztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGFydGljbGVJbWFnZS5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgICAgICAgIGFydGljbGVJbWFnZS5zdHlsZS50b3AgPSAnNDBweCc7XG4gICAgICAgICAgICAgIGFydGljbGVJbWFnZS5zdHlsZS5ib3R0b20gPSAnYXV0byc7XG4gICAgICAgICAgICAgIGFydGljbGVJbWFnZS5zdHlsZS53aWR0aCA9IGFydGljbGVJbWFnZS5vZmZzZXRXaWR0aCArICdweCc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGN1cnJlbnRQYWdlWVBvc2l0aW9uID0gcGFnZVlPZmZzZXQ7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFydGljbGUnKS5zdHlsZS5wYWRkaW5nTGVmdCA9ICcxNnB4JztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBuZXcgU3RhcnRTY3JpcHRzKCk7XG5cbiAgd2luZG93Lm9ucmVzaXplID0gU3RhcnRTY3JpcHRzO1xufSk7XG5cblxuLy8gLy8g0JXRgdC70Lgg0LTQvtC70LbQtdC9INCx0YvRgtGMINC90LDQudC00LXQvSDQvtC00LjQvSDRjdC70LXQvNC10L3RglxuLy8gaWYoKGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Zvcm1cIikpICE9PSBudWxsKVxuLy8gICBlLmNsYXNzTGlzdC5hZGQoJ2xhc3QnKTsgLy8g0JDQvdCw0LvQvtCzINCy0YvQsdC+0YDQutC4INC4INC/0YDQuNGB0LLQvtC10L3QuNGPINC60LvQsNGB0YHQsFxuLy8gLy8g0JXRgdC70Lgg0Y3Qu9C10LzQtdC90YLQvtCyINCx0YPQtNC10YIg0LzQvdC+0LPQvlxuLy8gQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiI2Zvcm1cIiksIGZ1bmN0aW9uKGUpe1xuLy8gICBlLmNsYXNzTGlzdC5hZGQoJ2xhc3QnKTtcbi8vIH0pO1xuIl19
