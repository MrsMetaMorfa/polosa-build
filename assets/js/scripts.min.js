/*!
 * gulp-nunjucks-sass-template
 * A Gulp 4 template including SCSS, Nunjucks, JS and more
 *
 * Url: https://github.com/DefaultSimon
 * Author: Simon Goričar
 * Copyright 2019-2020. MIT licensed.
 */
document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".header_tags .tag");let t,o,r=[];function n(){if(console.log(window.innerWidth>=1024,window.innerWidth>window.innerHeight),document.querySelector(".compilation")){let e,t,o,r=document.querySelectorAll(".compilation .item");window.innerWidth<1024&&window.innerWidth<window.innerHeight?(e=r[0].querySelector(".item_image").offsetWidth,t=e/2*3,Array.prototype.forEach.call(r,function(e){e.querySelector(".item_image").style.height=t+"px"})):(e=r[0].offsetWidth,t=r[0].classList.contains("wide")?(e-40)/151*106:(e-40)/53*76,Array.prototype.forEach.call(r,function(e){let r=e.querySelector(".item_image");o=e.querySelector(".item_tags"),r.style.height=t+"px",o.style.top=t+"px"}))}function n(e,t){t&&(t.onclick=(()=>new function(){e.classList.toggle("open")}))}if(document.querySelector("#copyLink")&&document.querySelector("#copyLink").addEventListener("click",()=>{let e=document.createElement("input"),t=window.location.href;document.body.appendChild(e),e.value=t,e.select(),document.execCommand("copy"),document.body.removeChild(e)}),document.querySelector(".header_tags")){let n=document.querySelector(".header_tags"),c=document.querySelector(".header_tags .tag_list"),i=document.querySelector(".header_tags .tag-wrapper"),a=0,s=n.offsetWidth,u=i.offsetWidth,d=0,y=Array.prototype.slice.call(e),f=r.slice();function l(e){if(d=u-24,document.querySelector(".header_tags .tag.current"))do{d+=f[e],e++}while(d<=s-u-24-26&&e<y.length);else do{d+=f[e],e++}while(d<=s-u-24&&e<y.length);return e}a=l(a);let h=document.querySelectorAll(".header_tags .tag");if(t){if(o()>a){let e=f[o()];y.splice(o(),1),f.splice(o(),1);let r=a-1;y.splice(r,0,t),f.splice(r,0,e)}a=l(a=0)}Array.prototype.forEach.call(h,function(e){e.remove()});for(let e=0;e<a;e++)i.before(y[e]);for(let e=a;e<y.length;e++)c.append(y[e]);n.style.flexWrap="nowrap"}if(document.querySelector(".header_tags")||document.querySelector(".header_menu")||document.querySelector(".header_notification")||document.querySelector(".header_language")||document.querySelector(".article .share")){let e,t,o,r,l,c,i,a,s,u,d,y,f,h,g;document.querySelector(".header_menu")&&(e=document.querySelector(".header_menu"),t=e.querySelector(".menu"),o=e.querySelector(".btn-icon")),new n(t,o),document.querySelector(".header_language")&&(r=document.querySelector(".header_language"),l=r.querySelector(".language"),c=r.querySelector(".btn-icon")),new n(l,c),document.querySelector(".header_notification")&&(i=document.querySelector(".header_notification"),a=i.querySelector(".notification"),s=i.querySelector(".btn-icon")),new n(a,s),document.querySelector(".header_tags")&&(u=document.querySelector(".header_tags .tag-wrapper"),d=u.querySelector(".tag_list"),y=u.querySelector(".tag-button")),new n(d,y),document.querySelector(".article .share")&&(f=document.querySelector(".article .share"),h=f.querySelector(".share_list"),g=f.querySelector(".share_button")),new n(h,g),document.onclick=(e=>{let r,n,i,u,f,p,m,q,S,w,_,H,x,W,b,L=e.target;document.querySelector(".header_menu")&&(r=L===t||t.contains(L),n=L===o,i=t.classList.contains("open")),document.querySelector(".header_language")&&(u=L===l||l.contains(L),f=L===c,p=l.classList.contains("open")),document.querySelector(".header_notification")&&(m=L===a||a.contains(L),q=L===s,S=a.classList.contains("open")),document.querySelector(".header_tags")&&(w=L===d||d.contains(L),_=L===y,H=d.classList.contains("open")),document.querySelector(".article .share")&&(x=L===h||h.contains(L),W=L===g,b=h.classList.contains("open")),document.querySelector(".header_menu")&&!r&&!n&&i&&t.classList.toggle("open"),document.querySelector(".header_language")&&!u&&!f&&p&&l.classList.toggle("open"),document.querySelector(".header_notification")&&!m&&!q&&S&&a.classList.toggle("open"),document.querySelector(".header_tags")&&!w&&!_&&H&&d.classList.toggle("open"),console.log(document.querySelector(".article .share"),h,!x,!W,b),document.querySelector(".article .share")&&!x&&!W&&b&&h.classList.toggle("open")})}let c=document.querySelector(".article"),i=document.querySelector(".article_image");if(c)if(console.log(i.offsetWidth,i.offsetHeight),document.querySelector(".article_image-picture").style.height="auto",i.style.width="auto",window.innerWidth>window.innerHeight&&window.innerWidth>1024){let e,t,o=document.querySelector(".article_image-picture"),r=document.querySelector(".article_image-caption");o.style.height="auto",c.offsetWidth/2<c.querySelector(".wrapper").offsetWidth&&c.offsetWidth<1100?(console.log("tablet landscape"),o.offsetHeight+r.offsetHeight+80>window.innerHeight?(o.querySelector(".vertical").style.display="none",o.querySelector(".horizontal").style.display="block",e=(t=o.offsetWidth)/125*88):(o.querySelector(".vertical").style.display="block",o.querySelector(".horizontal").style.display="none",o.style.height=i.offsetHeight-r.offsetHeight+"px",t=(e=o.offsetHeight)/153*102),i.style.width=t+"px",document.querySelector(".article").style.paddingLeft=t+40+"px"):(console.log(o.offsetHeight,r.offsetHeight,window.innerHeight),o.offsetHeight+r.offsetHeight+80+40>=window.innerHeight?(o.querySelector(".vertical").style.display="none",o.querySelector(".horizontal").style.display="block",e=(t=o.offsetWidth)/125*88):(o.querySelector(".vertical").style.display="block",o.querySelector(".horizontal").style.display="none",t=(e=o.offsetHeight)/153*102),i.style.width=t+"px",document.querySelector(".article").style.paddingLeft=t+40+"px");let n=0,l=0;document.onscroll=function(){if(document.querySelector(".article")){let e,t=document.querySelector("section.article").offsetHeight,o=document.querySelector(".header").offsetHeight,r=document.querySelector(".banners_container"),c=r.offsetHeight,a=document.querySelector(".banners_wrapper").offsetHeight,s=document.querySelector(".content").offsetHeight,u=pageYOffset-n;c-a>0&&(c-a>(l+=e=u/(s/(c-a+140)))?r.style.transform="translateY("+-1*l+"px)":c-a<=l?r.style.transform="translateY("+-1*(c-a)+"px)":l<0&&(r.style.transform="translateY(0px)")),console.log(pageYOffset,t+o-80-i.offsetHeight),console.log(t,o,i.offsetHeight),pageYOffset>73&&pageYOffset<o+t-80-(i.offsetHeight+40)?(i.style.position="fixed",i.style.top="40px",i.style.bottom="auto",i.style.width=i.offsetWidth+"px"):pageYOffset>73&&pageYOffset>=o+t-80-(i.offsetHeight+40)?(i.style.position="absolute",i.style.top="auto",i.style.bottom="80px",i.style.width=i.offsetWidth+"px"):(i.style.position="absolute",i.style.top="40px",i.style.bottom="auto",i.style.width=i.offsetWidth+"px"),n=pageYOffset}}}else document.querySelector(".article").style.paddingLeft="16px"}document.querySelector(".header_tags")&&(Array.prototype.forEach.call(e,function(e){r.push(e.offsetWidth+12)}),t=document.querySelector(".header_tags .tag.current"),o=function(){if(null!==t)return Array.prototype.slice.call(e).indexOf(t)}),new n,window.onresize=n});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMuanMiXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwidGFnc0xpc3REZWZhdWx0IiwicXVlcnlTZWxlY3RvckFsbCIsImN1cnJlbnRUYWciLCJjdXJyZW50VGFnSW5kZXgiLCJ0YWdzV2lkdGhMaXN0RGVmYXVsdCIsIlN0YXJ0U2NyaXB0cyIsImNvbnNvbGUiLCJsb2ciLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJxdWVyeVNlbGVjdG9yIiwiaXRlbVdpZHRoIiwiaW1hZ2VIZWlnaHQiLCJpdGVtVGFncyIsIml0ZW1zT25QYWdlIiwib2Zmc2V0V2lkdGgiLCJBcnJheSIsInByb3RvdHlwZSIsImZvckVhY2giLCJjYWxsIiwiZWxlbSIsInN0eWxlIiwiaGVpZ2h0IiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJpbWFnZSIsInRvcCIsIlRvZ2dsZUJsb2NrIiwiYmxvY2siLCJidXR0b24iLCJvbmNsaWNrIiwidG9nZ2xlIiwiZHVtbXkiLCJjcmVhdGVFbGVtZW50IiwidGV4dCIsImxvY2F0aW9uIiwiaHJlZiIsImJvZHkiLCJhcHBlbmRDaGlsZCIsInZhbHVlIiwic2VsZWN0IiwiZXhlY0NvbW1hbmQiLCJyZW1vdmVDaGlsZCIsInRhZ05hdiIsInRhZ01vcmVMaXN0IiwidGFnTW9yZUJ1dHRvbiIsImkiLCJ0YWdOYXZXaWR0aCIsInRhZ01vcmVCdXR0b25XaWR0aCIsInRhZ3NWaXNpYmxlV2lkdGgiLCJ0YWdzTGlzdCIsInNsaWNlIiwidGFnc1dpZHRoTGlzdCIsIkZpbmRUYWdzVmlzaWJsZVdpZHRoIiwiaW5kZXgiLCJsZW5ndGgiLCJhbGxOYXZUYWdzIiwiY3VycmVudFRhZ1dpZHRoIiwic3BsaWNlIiwiayIsInJlbW92ZSIsImIiLCJiZWZvcmUiLCJsIiwiYXBwZW5kIiwiZmxleFdyYXAiLCJtZW51V3JhcHBlciIsIm1lbnUiLCJtZW51QnV0dG9uIiwibGFuZ3VhZ2VXcmFwcGVyIiwibGFuZ3VhZ2UiLCJsYW5ndWFnZUJ1dHRvbiIsIm5vdGlmaWNhdGlvbldyYXBwZXIiLCJub3RpZmljYXRpb24iLCJub3RpZmljYXRpb25CdXR0b24iLCJuYXZXcmFwcGVyIiwibmF2TGlzdCIsIm5hdkJ1dHRvbiIsInNoYXJlV3JhcHBlciIsInNoYXJlTGlzdCIsInNoYXJlQnV0dG9uIiwiZSIsIml0c01lbnUiLCJpdHNNZW51QnV0dG9uIiwibWVudUlzQWN0aXZlIiwiaXRzTGFuZ3VhZ2UiLCJpdHNMYW5ndWFnZUJ1dHRvbiIsImxhbmd1YWdlSXNBY3RpdmUiLCJpdHNOb3RpZmljYXRpb24iLCJpdHNOb3RpZmljYXRpb25CdXR0b24iLCJub3RpZmljYXRpb25Jc0FjdGl2ZSIsIml0c0xpc3QiLCJpdHNMaXN0QnV0dG9uIiwibGlzdElzQWN0aXZlIiwiaXRzU2hhcmVMaXN0IiwiaXRzU2hhcmVMaXN0QnV0dG9uIiwic2hhcmVMaXN0SXNBY3RpdmUiLCJ0YXJnZXQiLCJhcnRpY2xlIiwiYXJ0aWNsZUltYWdlIiwib2Zmc2V0SGVpZ2h0Iiwid2lkdGgiLCJwaWN0dXJlSGVpZ2h0IiwicGljdHVyZVdpZHRoIiwicGljdHVyZSIsImNhcHRpb24iLCJkaXNwbGF5IiwicGFkZGluZ0xlZnQiLCJjdXJyZW50UGFnZVlQb3NpdGlvbiIsImJhbm5lcnNTY3JvbGwiLCJvbnNjcm9sbCIsImJhbm5lcnNTY3JvbGxOZXciLCJhcnRpY2xlSGVpZ2h0IiwiaGVhZGVySGVpZ2h0IiwiYmFubmVyc0NvbnRhaW5lciIsImJhbm5lcnNDb250YWluZXJIZWlnaHQiLCJiYW5uZXJzV3JhcHBlckhlaWdodCIsImNvbnRlbnRIZWlnaHQiLCJzY3JvbGxEaWZmZXJlbmNlIiwicGFnZVlPZmZzZXQiLCJ0cmFuc2Zvcm0iLCJwb3NpdGlvbiIsImJvdHRvbSIsInB1c2giLCJpbmRleE9mIiwib25yZXNpemUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQ0FBLFNBQUFDLGlCQUFBLG1CQUFBLFdBQ0EsTUFBQUMsRUFBQUYsU0FBQUcsaUJBQUEscUJB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L0YsUUFBQUMsSUFBQTBHLEVBQUFDLEVBQUFkLEVBQUFDLGNBQ0FtQixZQUFBLElBQUFBLFlBQUFOLEVBQUFELEVBQUEsSUFBQWIsRUFBQUMsYUFBQSxLQUNBRCxFQUFBOUUsTUFBQW9HLFNBQUEsUUFDQXRCLEVBQUE5RSxNQUFBSyxJQUFBLE9BQ0F5RSxFQUFBOUUsTUFBQXFHLE9BQUEsT0FDQXZCLEVBQUE5RSxNQUFBZ0YsTUFBQUYsRUFBQXBGLFlBQUEsTUFDQXdHLFlBQUEsSUFBQUEsYUFBQU4sRUFBQUQsRUFBQSxJQUFBYixFQUFBQyxhQUFBLEtBQ0FELEVBQUE5RSxNQUFBb0csU0FBQSxXQUNBdEIsRUFBQTlFLE1BQUFLLElBQUEsT0FDQXlFLEVBQUE5RSxNQUFBcUcsT0FBQSxPQUNBdkIsRUFBQTlFLE1BQUFnRixNQUFBRixFQUFBcEYsWUFBQSxPQUVBb0YsRUFBQTlFLE1BQUFvRyxTQUFBLFdBQ0F0QixFQUFBOUUsTUFBQUssSUFBQSxPQUNBeUUsRUFBQTlFLE1BQUFxRyxPQUFBLE9BQ0F2QixFQUFBOUUsTUFBQWdGLE1BQUFGLEVBQUFwRixZQUFBLE1BR0E2RixFQUFBVyxtQkFJQTFILFNBQUFhLGNBQUEsWUFBQVcsTUFBQXNGLFlBQUEsT0F6U0E5RyxTQUFBYSxjQUFBLGtCQUNBTSxNQUFBQyxVQUFBQyxRQUFBQyxLQUFBcEIsRUFBQSxTQUFBcUIsR0FDQWpCLEVBQUF3SCxLQUFBdkcsRUFBQUwsWUFBQSxNQU5BZCxFQUFBSixTQUFBYSxjQUFBLDZCQUNBUixFQUFBLFdBQ0EsR0FBQSxPQUFBRCxFQUNBLE9BQUFlLE1BQUFDLFVBQUFrQyxNQUFBaEMsS0FBQXBCLEdBQUE2SCxRQUFBM0gsS0ErU0EsSUFBQUcsRUFFQUcsT0FBQXNILFNBQUF6SCIsImZpbGUiOiJzY3JpcHRzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vINCQ0L3QsNC70L7QsyAkKGRvY3VtZW50KS5yZWFkeSgpXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7XG4gIGNvbnN0IHRhZ3NMaXN0RGVmYXVsdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5oZWFkZXJfdGFncyAudGFnJyk7XG4gIGxldCB0YWdzV2lkdGhMaXN0RGVmYXVsdCA9IFtdLCBjdXJyZW50VGFnLCBjdXJyZW50VGFnSW5kZXg7XG4gIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX3RhZ3MnKSkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwodGFnc0xpc3REZWZhdWx0LCBmdW5jdGlvbihlbGVtKSB7XG4gICAgICB0YWdzV2lkdGhMaXN0RGVmYXVsdC5wdXNoKCBlbGVtLm9mZnNldFdpZHRoICsgMTIgKTtcbiAgICB9KTtcbiAgICBjdXJyZW50VGFnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl90YWdzIC50YWcuY3VycmVudCcpO1xuICAgIGN1cnJlbnRUYWdJbmRleCA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKGN1cnJlbnRUYWcgIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRhZ3NMaXN0RGVmYXVsdCkuaW5kZXhPZihjdXJyZW50VGFnKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gU3RhcnRTY3JpcHRzKCkge1xuICAgIGNvbnNvbGUubG9nKCh3aW5kb3cuaW5uZXJXaWR0aCA+PSAxMDI0KSwgKHdpbmRvdy5pbm5lcldpZHRoID4gd2luZG93LmlubmVySGVpZ2h0KSk7XG5cbiAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbXBpbGF0aW9uJykpIHtcbiAgICAgIGxldCBpdGVtc09uUGFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb21waWxhdGlvbiAuaXRlbScpLCBpdGVtV2lkdGgsIGltYWdlSGVpZ2h0LCBpdGVtVGFncztcbiAgICAgIGlmICgod2luZG93LmlubmVyV2lkdGggPCAxMDI0KSAmJiAod2luZG93LmlubmVyV2lkdGggPCB3aW5kb3cuaW5uZXJIZWlnaHQpKSB7IC8vcG9ydHJhaXRcbiAgICAgICAgaXRlbVdpZHRoID0gaXRlbXNPblBhZ2VbMF0ucXVlcnlTZWxlY3RvcignLml0ZW1faW1hZ2UnKS5vZmZzZXRXaWR0aDtcbiAgICAgICAgaW1hZ2VIZWlnaHQgPSBpdGVtV2lkdGggLyAyICogMztcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChpdGVtc09uUGFnZSwgZnVuY3Rpb24oZWxlbSl7XG4gICAgICAgICAgbGV0IGltYWdlID0gZWxlbS5xdWVyeVNlbGVjdG9yKCcuaXRlbV9pbWFnZScpO1xuICAgICAgICAgIGltYWdlLnN0eWxlLmhlaWdodCA9IGltYWdlSGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpdGVtV2lkdGggPSBpdGVtc09uUGFnZVswXS5vZmZzZXRXaWR0aDtcbiAgICAgICAgaWYgKGl0ZW1zT25QYWdlWzBdLmNsYXNzTGlzdC5jb250YWlucygnd2lkZScpKSB7XG4gICAgICAgICAgaW1hZ2VIZWlnaHQgPSAoaXRlbVdpZHRoIC0gNDApIC8gMTUxICogMTA2O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGltYWdlSGVpZ2h0ID0gKGl0ZW1XaWR0aCAtIDQwKSAvIDUzICogNzY7XG4gICAgICAgIH1cbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChpdGVtc09uUGFnZSwgZnVuY3Rpb24oZWxlbSl7XG4gICAgICAgICAgbGV0IGltYWdlID0gZWxlbS5xdWVyeVNlbGVjdG9yKCcuaXRlbV9pbWFnZScpO1xuICAgICAgICAgIGl0ZW1UYWdzID0gZWxlbS5xdWVyeVNlbGVjdG9yKCcuaXRlbV90YWdzJyk7XG4gICAgICAgICAgaW1hZ2Uuc3R5bGUuaGVpZ2h0ID0gaW1hZ2VIZWlnaHQgKyAncHgnO1xuICAgICAgICAgIGl0ZW1UYWdzLnN0eWxlLnRvcCA9IGltYWdlSGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjb3B5TGluaycpKSB7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY29weUxpbmsnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgbGV0IGR1bW15ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKSxcbiAgICAgICAgICAgIHRleHQgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcblxuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGR1bW15KTtcbiAgICAgICAgZHVtbXkudmFsdWUgPSB0ZXh0O1xuICAgICAgICBkdW1teS5zZWxlY3QoKTtcbiAgICAgICAgZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ2NvcHknKTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChkdW1teSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBUb2dnbGVCbG9jayhibG9jaywgYnV0dG9uKSB7XG4gICAgICBsZXQgVG9nZ2xlTWVudSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBibG9jay5jbGFzc0xpc3QudG9nZ2xlKCdvcGVuJyk7XG4gICAgICB9O1xuICAgICAgaWYgKGJ1dHRvbikge1xuICAgICAgICBidXR0b24ub25jbGljayA9ICgpID0+IChuZXcgVG9nZ2xlTWVudSgpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl90YWdzJykpIHtcbiAgICAgIGxldCB0YWdOYXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX3RhZ3MnKSxcbiAgICAgICAgICB0YWdNb3JlTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfdGFncyAudGFnX2xpc3QnKSxcbiAgICAgICAgICB0YWdNb3JlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl90YWdzIC50YWctd3JhcHBlcicpLFxuICAgICAgICAgIGkgPSAwLFxuICAgICAgICAgIHRhZ05hdldpZHRoID0gdGFnTmF2Lm9mZnNldFdpZHRoLFxuICAgICAgICAgIHRhZ01vcmVCdXR0b25XaWR0aCA9IHRhZ01vcmVCdXR0b24ub2Zmc2V0V2lkdGgsXG4gICAgICAgICAgdGFnc1Zpc2libGVXaWR0aCA9IDAsXG4gICAgICAgICAgdGFnc0xpc3QgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0YWdzTGlzdERlZmF1bHQpLFxuICAgICAgICAgIHRhZ3NXaWR0aExpc3QgPSB0YWdzV2lkdGhMaXN0RGVmYXVsdC5zbGljZSgpO1xuICAgICAgZnVuY3Rpb24gRmluZFRhZ3NWaXNpYmxlV2lkdGgoaW5kZXgpIHtcbiAgICAgICAgdGFnc1Zpc2libGVXaWR0aCA9IHRhZ01vcmVCdXR0b25XaWR0aCAtIDI0O1xuICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl90YWdzIC50YWcuY3VycmVudCcpKSB7XG4gICAgICAgICAgZG8ge1xuICAgICAgICAgICAgdGFnc1Zpc2libGVXaWR0aCA9IHRhZ3NWaXNpYmxlV2lkdGggKyB0YWdzV2lkdGhMaXN0W2luZGV4XTtcbiAgICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgfSB3aGlsZSAoKHRhZ3NWaXNpYmxlV2lkdGggPD0gKHRhZ05hdldpZHRoIC0gdGFnTW9yZUJ1dHRvbldpZHRoIC0gMjQgLSAyNikpICYmIChpbmRleCA8IHRhZ3NMaXN0Lmxlbmd0aCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgIHRhZ3NWaXNpYmxlV2lkdGggPSB0YWdzVmlzaWJsZVdpZHRoICsgdGFnc1dpZHRoTGlzdFtpbmRleF07XG4gICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgIH0gd2hpbGUgKCh0YWdzVmlzaWJsZVdpZHRoIDw9ICh0YWdOYXZXaWR0aCAtIHRhZ01vcmVCdXR0b25XaWR0aCAtIDI0KSkgJiYgKGluZGV4IDwgdGFnc0xpc3QubGVuZ3RoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgfVxuICAgICAgaSA9IEZpbmRUYWdzVmlzaWJsZVdpZHRoKGkpO1xuICAgICAgbGV0IGFsbE5hdlRhZ3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaGVhZGVyX3RhZ3MgLnRhZycpO1xuICAgICAgaWYgKGN1cnJlbnRUYWcpIHtcbiAgICAgICAgaWYgKGN1cnJlbnRUYWdJbmRleCgpID4gaSkge1xuICAgICAgICAgIGxldCBjdXJyZW50VGFnV2lkdGggPSB0YWdzV2lkdGhMaXN0W2N1cnJlbnRUYWdJbmRleCgpXTtcbiAgICAgICAgICB0YWdzTGlzdC5zcGxpY2UoY3VycmVudFRhZ0luZGV4KCksIDEpO1xuICAgICAgICAgIHRhZ3NXaWR0aExpc3Quc3BsaWNlKGN1cnJlbnRUYWdJbmRleCgpLCAxKTtcbiAgICAgICAgICBsZXQgayA9IGkgLSAxO1xuICAgICAgICAgIHRhZ3NMaXN0LnNwbGljZShrLCAwLCBjdXJyZW50VGFnKTtcbiAgICAgICAgICB0YWdzV2lkdGhMaXN0LnNwbGljZShrLCAwLCBjdXJyZW50VGFnV2lkdGgpO1xuICAgICAgICB9XG4gICAgICAgIGkgPSAwO1xuICAgICAgICBpID0gRmluZFRhZ3NWaXNpYmxlV2lkdGgoaSk7XG4gICAgICB9XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGFsbE5hdlRhZ3MsIGZ1bmN0aW9uIChlbGVtKSB7XG4gICAgICAgIGVsZW0ucmVtb3ZlKCk7XG4gICAgICB9KTtcbiAgICAgIGZvciAobGV0IGIgPSAwOyBiIDwgaTsgYisrKSB7XG4gICAgICAgIHRhZ01vcmVCdXR0b24uYmVmb3JlKHRhZ3NMaXN0W2JdKTtcbiAgICAgIH1cbiAgICAgIGZvciAobGV0IGwgPSBpOyBsIDwgdGFnc0xpc3QubGVuZ3RoOyBsKyspIHtcbiAgICAgICAgdGFnTW9yZUxpc3QuYXBwZW5kKHRhZ3NMaXN0W2xdKTtcbiAgICAgIH1cbiAgICAgIHRhZ05hdi5zdHlsZS5mbGV4V3JhcCA9ICdub3dyYXAnO1xuICAgIH1cblxuICAgIGlmIChcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfdGFncycpIHx8XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX21lbnUnKSB8fFxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9ub3RpZmljYXRpb24nKSB8fFxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9sYW5ndWFnZScpIHx8XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXJ0aWNsZSAuc2hhcmUnKVxuICAgICkge1xuICAgICAgbGV0IG1lbnVXcmFwcGVyLCBtZW51LCBtZW51QnV0dG9uO1xuICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfbWVudScpKSB7XG4gICAgICAgIG1lbnVXcmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9tZW51Jyk7XG4gICAgICAgIG1lbnUgPSBtZW51V3JhcHBlci5xdWVyeVNlbGVjdG9yKCcubWVudScpO1xuICAgICAgICBtZW51QnV0dG9uID0gbWVudVdyYXBwZXIucXVlcnlTZWxlY3RvcignLmJ0bi1pY29uJyk7XG4gICAgICB9XG4gICAgICBuZXcgVG9nZ2xlQmxvY2sobWVudSwgbWVudUJ1dHRvbik7XG5cbiAgICAgIGxldCBsYW5ndWFnZVdyYXBwZXIsIGxhbmd1YWdlLCBsYW5ndWFnZUJ1dHRvbjtcbiAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX2xhbmd1YWdlJykpIHtcbiAgICAgICAgbGFuZ3VhZ2VXcmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9sYW5ndWFnZScpO1xuICAgICAgICBsYW5ndWFnZSA9IGxhbmd1YWdlV3JhcHBlci5xdWVyeVNlbGVjdG9yKCcubGFuZ3VhZ2UnKTtcbiAgICAgICAgbGFuZ3VhZ2VCdXR0b24gPSBsYW5ndWFnZVdyYXBwZXIucXVlcnlTZWxlY3RvcignLmJ0bi1pY29uJyk7XG4gICAgICB9XG4gICAgICBuZXcgVG9nZ2xlQmxvY2sobGFuZ3VhZ2UsIGxhbmd1YWdlQnV0dG9uKTtcblxuICAgICAgbGV0IG5vdGlmaWNhdGlvbldyYXBwZXIsIG5vdGlmaWNhdGlvbiwgbm90aWZpY2F0aW9uQnV0dG9uO1xuICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfbm90aWZpY2F0aW9uJykpIHtcbiAgICAgICAgbm90aWZpY2F0aW9uV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfbm90aWZpY2F0aW9uJyk7XG4gICAgICAgIG5vdGlmaWNhdGlvbiA9IG5vdGlmaWNhdGlvbldyYXBwZXIucXVlcnlTZWxlY3RvcignLm5vdGlmaWNhdGlvbicpO1xuICAgICAgICBub3RpZmljYXRpb25CdXR0b24gPSBub3RpZmljYXRpb25XcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy5idG4taWNvbicpO1xuICAgICAgfVxuICAgICAgbmV3IFRvZ2dsZUJsb2NrKG5vdGlmaWNhdGlvbiwgbm90aWZpY2F0aW9uQnV0dG9uKTtcblxuICAgICAgbGV0IG5hdldyYXBwZXIsIG5hdkxpc3QsIG5hdkJ1dHRvbjtcbiAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX3RhZ3MnKSkge1xuICAgICAgICBuYXZXcmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl90YWdzIC50YWctd3JhcHBlcicpO1xuICAgICAgICBuYXZMaXN0ID0gbmF2V3JhcHBlci5xdWVyeVNlbGVjdG9yKCcudGFnX2xpc3QnKTtcbiAgICAgICAgbmF2QnV0dG9uID0gbmF2V3JhcHBlci5xdWVyeVNlbGVjdG9yKCcudGFnLWJ1dHRvbicpO1xuICAgICAgfVxuICAgICAgbmV3IFRvZ2dsZUJsb2NrKG5hdkxpc3QsIG5hdkJ1dHRvbik7XG5cbiAgICAgIGxldCBzaGFyZVdyYXBwZXIsIHNoYXJlTGlzdCwgc2hhcmVCdXR0b247XG4gICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFydGljbGUgLnNoYXJlJykpIHtcbiAgICAgICAgc2hhcmVXcmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFydGljbGUgLnNoYXJlJyk7XG4gICAgICAgIHNoYXJlTGlzdCA9IHNoYXJlV3JhcHBlci5xdWVyeVNlbGVjdG9yKCcuc2hhcmVfbGlzdCcpO1xuICAgICAgICBzaGFyZUJ1dHRvbiA9IHNoYXJlV3JhcHBlci5xdWVyeVNlbGVjdG9yKCcuc2hhcmVfYnV0dG9uJyk7XG4gICAgICB9XG4gICAgICBuZXcgVG9nZ2xlQmxvY2soc2hhcmVMaXN0LCBzaGFyZUJ1dHRvbik7XG5cbiAgICAgIGRvY3VtZW50Lm9uY2xpY2sgPSAoZSkgPT4ge1xuICAgICAgICBsZXQgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gICAgICAgIGxldCBpdHNNZW51LCBpdHNNZW51QnV0dG9uLCBtZW51SXNBY3RpdmU7XG4gICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX21lbnUnKSkge1xuICAgICAgICAgICAgaXRzTWVudSA9IHRhcmdldCA9PT0gbWVudSB8fCBtZW51LmNvbnRhaW5zKHRhcmdldCk7XG4gICAgICAgICAgICBpdHNNZW51QnV0dG9uID0gdGFyZ2V0ID09PSBtZW51QnV0dG9uO1xuICAgICAgICAgICAgbWVudUlzQWN0aXZlID0gbWVudS5jbGFzc0xpc3QuY29udGFpbnMoJ29wZW4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBpdHNMYW5ndWFnZSwgaXRzTGFuZ3VhZ2VCdXR0b24sIGxhbmd1YWdlSXNBY3RpdmU7XG4gICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX2xhbmd1YWdlJykpIHtcbiAgICAgICAgICBpdHNMYW5ndWFnZSA9IHRhcmdldCA9PT0gbGFuZ3VhZ2UgfHwgbGFuZ3VhZ2UuY29udGFpbnModGFyZ2V0KTtcbiAgICAgICAgICBpdHNMYW5ndWFnZUJ1dHRvbiA9IHRhcmdldCA9PT0gbGFuZ3VhZ2VCdXR0b247XG4gICAgICAgICAgbGFuZ3VhZ2VJc0FjdGl2ZSA9IGxhbmd1YWdlLmNsYXNzTGlzdC5jb250YWlucygnb3BlbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGl0c05vdGlmaWNhdGlvbiwgaXRzTm90aWZpY2F0aW9uQnV0dG9uLCBub3RpZmljYXRpb25Jc0FjdGl2ZTtcbiAgICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfbm90aWZpY2F0aW9uJykpIHtcbiAgICAgICAgICBpdHNOb3RpZmljYXRpb24gPSB0YXJnZXQgPT09IG5vdGlmaWNhdGlvbiB8fCBub3RpZmljYXRpb24uY29udGFpbnModGFyZ2V0KTtcbiAgICAgICAgICBpdHNOb3RpZmljYXRpb25CdXR0b24gPSB0YXJnZXQgPT09IG5vdGlmaWNhdGlvbkJ1dHRvbjtcbiAgICAgICAgICBub3RpZmljYXRpb25Jc0FjdGl2ZSA9IG5vdGlmaWNhdGlvbi5jbGFzc0xpc3QuY29udGFpbnMoJ29wZW4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBpdHNMaXN0LCBpdHNMaXN0QnV0dG9uLCBsaXN0SXNBY3RpdmU7XG4gICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX3RhZ3MnKSkge1xuICAgICAgICAgIGl0c0xpc3QgPSB0YXJnZXQgPT09IG5hdkxpc3QgfHwgbmF2TGlzdC5jb250YWlucyh0YXJnZXQpO1xuICAgICAgICAgIGl0c0xpc3RCdXR0b24gPSB0YXJnZXQgPT09IG5hdkJ1dHRvbjtcbiAgICAgICAgICBsaXN0SXNBY3RpdmUgPSBuYXZMaXN0LmNsYXNzTGlzdC5jb250YWlucygnb3BlbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGl0c1NoYXJlTGlzdCwgaXRzU2hhcmVMaXN0QnV0dG9uLCBzaGFyZUxpc3RJc0FjdGl2ZTtcbiAgICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcnRpY2xlIC5zaGFyZScpKSB7XG4gICAgICAgICAgaXRzU2hhcmVMaXN0ID0gdGFyZ2V0ID09PSBzaGFyZUxpc3QgfHwgc2hhcmVMaXN0LmNvbnRhaW5zKHRhcmdldCk7XG4gICAgICAgICAgaXRzU2hhcmVMaXN0QnV0dG9uID0gdGFyZ2V0ID09PSBzaGFyZUJ1dHRvbjtcbiAgICAgICAgICBzaGFyZUxpc3RJc0FjdGl2ZSA9IHNoYXJlTGlzdC5jbGFzc0xpc3QuY29udGFpbnMoJ29wZW4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX21lbnUnKSAmJiAhaXRzTWVudSAmJiAhaXRzTWVudUJ1dHRvbiAmJiBtZW51SXNBY3RpdmUpIHtcbiAgICAgICAgICBtZW51LmNsYXNzTGlzdC50b2dnbGUoJ29wZW4nKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9sYW5ndWFnZScpICYmICFpdHNMYW5ndWFnZSAmJiAhaXRzTGFuZ3VhZ2VCdXR0b24gJiYgbGFuZ3VhZ2VJc0FjdGl2ZSkge1xuICAgICAgICAgIGxhbmd1YWdlLmNsYXNzTGlzdC50b2dnbGUoJ29wZW4nKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9ub3RpZmljYXRpb24nKSAmJiAhaXRzTm90aWZpY2F0aW9uICYmICFpdHNOb3RpZmljYXRpb25CdXR0b24gJiYgbm90aWZpY2F0aW9uSXNBY3RpdmUpIHtcbiAgICAgICAgICBub3RpZmljYXRpb24uY2xhc3NMaXN0LnRvZ2dsZSgnb3BlbicpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX3RhZ3MnKSAmJiAhaXRzTGlzdCAmJiAhaXRzTGlzdEJ1dHRvbiAmJiBsaXN0SXNBY3RpdmUpIHtcbiAgICAgICAgICBuYXZMaXN0LmNsYXNzTGlzdC50b2dnbGUoJ29wZW4nKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXJ0aWNsZSAuc2hhcmUnKSwgc2hhcmVMaXN0LCAhaXRzU2hhcmVMaXN0LCAhaXRzU2hhcmVMaXN0QnV0dG9uLCBzaGFyZUxpc3RJc0FjdGl2ZSk7XG4gICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXJ0aWNsZSAuc2hhcmUnKSAmJiAhaXRzU2hhcmVMaXN0ICYmICFpdHNTaGFyZUxpc3RCdXR0b24gJiYgc2hhcmVMaXN0SXNBY3RpdmUpIHtcbiAgICAgICAgICBzaGFyZUxpc3QuY2xhc3NMaXN0LnRvZ2dsZSgnb3BlbicpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cblxuICAgIGxldCBhcnRpY2xlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFydGljbGUnKSxcbiAgICAgICAgYXJ0aWNsZUltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFydGljbGVfaW1hZ2UnKTtcbiAgICBpZiAoYXJ0aWNsZSkge1xuICAgICAgY29uc29sZS5sb2coYXJ0aWNsZUltYWdlLm9mZnNldFdpZHRoLCBhcnRpY2xlSW1hZ2Uub2Zmc2V0SGVpZ2h0KTtcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcnRpY2xlX2ltYWdlLXBpY3R1cmUnKS5zdHlsZS5oZWlnaHQgPSAnYXV0byc7XG4gICAgICBhcnRpY2xlSW1hZ2Uuc3R5bGUud2lkdGggPSAnYXV0byc7XG4gICAgICBpZiAoKHdpbmRvdy5pbm5lcldpZHRoID4gd2luZG93LmlubmVySGVpZ2h0KSAmJiAod2luZG93LmlubmVyV2lkdGggPiAxMDI0KSkge1xuICAgICAgICBsZXQgcGljdHVyZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcnRpY2xlX2ltYWdlLXBpY3R1cmUnKSxcbiAgICAgICAgICBjYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFydGljbGVfaW1hZ2UtY2FwdGlvbicpLFxuICAgICAgICAgIHBpY3R1cmVIZWlnaHQsIHBpY3R1cmVXaWR0aDtcbiAgICAgICAgcGljdHVyZS5zdHlsZS5oZWlnaHQgPSAnYXV0byc7XG4gICAgICAgIGlmICgoKGFydGljbGUub2Zmc2V0V2lkdGggLyAyKSA8IChhcnRpY2xlLnF1ZXJ5U2VsZWN0b3IoJy53cmFwcGVyJykub2Zmc2V0V2lkdGgpKSAmJiAoYXJ0aWNsZS5vZmZzZXRXaWR0aCA8IDExMDApKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ3RhYmxldCBsYW5kc2NhcGUnKTtcbiAgICAgICAgICBpZiAoKHBpY3R1cmUub2Zmc2V0SGVpZ2h0ICsgY2FwdGlvbi5vZmZzZXRIZWlnaHQgKyA4MCkgPiB3aW5kb3cuaW5uZXJIZWlnaHQpIHtcbiAgICAgICAgICAgIHBpY3R1cmUucXVlcnlTZWxlY3RvcignLnZlcnRpY2FsJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIHBpY3R1cmUucXVlcnlTZWxlY3RvcignLmhvcml6b250YWwnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIHBpY3R1cmVXaWR0aCA9IHBpY3R1cmUub2Zmc2V0V2lkdGg7XG4gICAgICAgICAgICBwaWN0dXJlSGVpZ2h0ID0gcGljdHVyZVdpZHRoIC8gMTI1ICogODg7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBpY3R1cmUucXVlcnlTZWxlY3RvcignLnZlcnRpY2FsJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICBwaWN0dXJlLnF1ZXJ5U2VsZWN0b3IoJy5ob3Jpem9udGFsJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIHBpY3R1cmUuc3R5bGUuaGVpZ2h0ID0gKGFydGljbGVJbWFnZS5vZmZzZXRIZWlnaHQgLSBjYXB0aW9uLm9mZnNldEhlaWdodCkgKyAncHgnO1xuICAgICAgICAgICAgcGljdHVyZUhlaWdodCA9IHBpY3R1cmUub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgICAgcGljdHVyZVdpZHRoID0gcGljdHVyZUhlaWdodCAvIDE1MyAqIDEwMjtcbiAgICAgICAgICB9XG4gICAgICAgICAgICBhcnRpY2xlSW1hZ2Uuc3R5bGUud2lkdGggPSBwaWN0dXJlV2lkdGggKyAncHgnO1xuICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcnRpY2xlJykuc3R5bGUucGFkZGluZ0xlZnQgPSBwaWN0dXJlV2lkdGggKyA0MCArICdweCc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2cocGljdHVyZS5vZmZzZXRIZWlnaHQsIGNhcHRpb24ub2Zmc2V0SGVpZ2h0LCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuICAgICAgICAgIGlmICgocGljdHVyZS5vZmZzZXRIZWlnaHQgKyBjYXB0aW9uLm9mZnNldEhlaWdodCArIDgwICsgNDApID49IHdpbmRvdy5pbm5lckhlaWdodCkge1xuICAgICAgICAgICAgcGljdHVyZS5xdWVyeVNlbGVjdG9yKCcudmVydGljYWwnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgcGljdHVyZS5xdWVyeVNlbGVjdG9yKCcuaG9yaXpvbnRhbCcpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgcGljdHVyZVdpZHRoID0gcGljdHVyZS5vZmZzZXRXaWR0aDtcbiAgICAgICAgICAgIHBpY3R1cmVIZWlnaHQgPSBwaWN0dXJlV2lkdGggLyAxMjUgKiA4ODtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGljdHVyZS5xdWVyeVNlbGVjdG9yKCcudmVydGljYWwnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIHBpY3R1cmUucXVlcnlTZWxlY3RvcignLmhvcml6b250YWwnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgcGljdHVyZUhlaWdodCA9IHBpY3R1cmUub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgICAgcGljdHVyZVdpZHRoID0gcGljdHVyZUhlaWdodCAvIDE1MyAqIDEwMjtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXJ0aWNsZUltYWdlLnN0eWxlLndpZHRoID0gcGljdHVyZVdpZHRoICsgJ3B4JztcbiAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXJ0aWNsZScpLnN0eWxlLnBhZGRpbmdMZWZ0ID0gcGljdHVyZVdpZHRoICsgNDAgKyAncHgnO1xuICAgICAgICB9XG4gICAgICAgIGxldCBjdXJyZW50UGFnZVlQb3NpdGlvbiA9IDAsIGJhbm5lcnNTY3JvbGwgPSAwO1xuICAgICAgICBkb2N1bWVudC5vbnNjcm9sbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFydGljbGUnKSkge1xuICAgICAgICAgICAgbGV0IGFydGljbGVIZWlnaHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdzZWN0aW9uLmFydGljbGUnKS5vZmZzZXRIZWlnaHQsXG4gICAgICAgICAgICAgIGhlYWRlckhlaWdodCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXInKS5vZmZzZXRIZWlnaHQ7XG5cbiAgICAgICAgICAgIGxldCBiYW5uZXJzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJhbm5lcnNfY29udGFpbmVyJyksXG4gICAgICAgICAgICAgIGJhbm5lcnNDb250YWluZXJIZWlnaHQgPSBiYW5uZXJzQ29udGFpbmVyLm9mZnNldEhlaWdodCxcbiAgICAgICAgICAgICAgYmFubmVyc1dyYXBwZXJIZWlnaHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYmFubmVyc193cmFwcGVyJykub2Zmc2V0SGVpZ2h0LFxuICAgICAgICAgICAgICBjb250ZW50SGVpZ2h0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRlbnQnKS5vZmZzZXRIZWlnaHQsXG4gICAgICAgICAgICAgIGJsb2Nrc0RpZmZlcmVuY2UgPSAoY29udGVudEhlaWdodCkgLyAoYmFubmVyc0NvbnRhaW5lckhlaWdodCAtIGJhbm5lcnNXcmFwcGVySGVpZ2h0ICsgMTQwKSxcbiAgICAgICAgICAgICAgc2Nyb2xsRGlmZmVyZW5jZSA9IHBhZ2VZT2Zmc2V0IC0gY3VycmVudFBhZ2VZUG9zaXRpb24sIGJhbm5lcnNTY3JvbGxOZXc7XG4gICAgICAgICAgICBpZiAoKGJhbm5lcnNDb250YWluZXJIZWlnaHQgLSBiYW5uZXJzV3JhcHBlckhlaWdodCkgPiAwKSB7XG4gICAgICAgICAgICAgIGJhbm5lcnNTY3JvbGxOZXcgPSBzY3JvbGxEaWZmZXJlbmNlIC8gYmxvY2tzRGlmZmVyZW5jZTtcbiAgICAgICAgICAgICAgYmFubmVyc1Njcm9sbCA9IGJhbm5lcnNTY3JvbGwgKyBiYW5uZXJzU2Nyb2xsTmV3O1xuICAgICAgICAgICAgICBpZiAoKGJhbm5lcnNDb250YWluZXJIZWlnaHQgLSBiYW5uZXJzV3JhcHBlckhlaWdodCkgPiBiYW5uZXJzU2Nyb2xsKSB7XG4gICAgICAgICAgICAgICAgYmFubmVyc0NvbnRhaW5lci5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWSgnICsgKGJhbm5lcnNTY3JvbGwgICogLTEpICsgJ3B4KSc7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoKGJhbm5lcnNDb250YWluZXJIZWlnaHQgLSBiYW5uZXJzV3JhcHBlckhlaWdodCkgPD0gYmFubmVyc1Njcm9sbCkge1xuICAgICAgICAgICAgICAgIGJhbm5lcnNDb250YWluZXIuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVkoJyArICgoYmFubmVyc0NvbnRhaW5lckhlaWdodCAtIGJhbm5lcnNXcmFwcGVySGVpZ2h0KSAgKiAtMSkgKyAncHgpJztcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChiYW5uZXJzU2Nyb2xsIDwgMCkge1xuICAgICAgICAgICAgICAgIGJhbm5lcnNDb250YWluZXIuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVkoJyArIDAgKyAncHgpJztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc29sZS5sb2cocGFnZVlPZmZzZXQsIGFydGljbGVIZWlnaHQgKyBoZWFkZXJIZWlnaHQgLSA4MCAtIGFydGljbGVJbWFnZS5vZmZzZXRIZWlnaHQpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coYXJ0aWNsZUhlaWdodCwgaGVhZGVySGVpZ2h0LCBhcnRpY2xlSW1hZ2Uub2Zmc2V0SGVpZ2h0KTtcbiAgICAgICAgICAgIGlmICgocGFnZVlPZmZzZXQgPiA3MykgJiYgKHBhZ2VZT2Zmc2V0IDwgKGhlYWRlckhlaWdodCArIGFydGljbGVIZWlnaHQgLSA4MCAtIChhcnRpY2xlSW1hZ2Uub2Zmc2V0SGVpZ2h0ICsgNDApKSkpIHtcbiAgICAgICAgICAgICAgYXJ0aWNsZUltYWdlLnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJztcbiAgICAgICAgICAgICAgYXJ0aWNsZUltYWdlLnN0eWxlLnRvcCA9ICc0MHB4JztcbiAgICAgICAgICAgICAgYXJ0aWNsZUltYWdlLnN0eWxlLmJvdHRvbSA9ICdhdXRvJztcbiAgICAgICAgICAgICAgYXJ0aWNsZUltYWdlLnN0eWxlLndpZHRoID0gYXJ0aWNsZUltYWdlLm9mZnNldFdpZHRoICsgJ3B4JztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoKHBhZ2VZT2Zmc2V0ID4gNzMpICYmIChwYWdlWU9mZnNldCA+PSAoaGVhZGVySGVpZ2h0ICsgYXJ0aWNsZUhlaWdodCAtIDgwIC0gKGFydGljbGVJbWFnZS5vZmZzZXRIZWlnaHQgKyA0MCkpKSkge1xuICAgICAgICAgICAgICBhcnRpY2xlSW1hZ2Uuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICAgICAgICBhcnRpY2xlSW1hZ2Uuc3R5bGUudG9wID0gJ2F1dG8nO1xuICAgICAgICAgICAgICBhcnRpY2xlSW1hZ2Uuc3R5bGUuYm90dG9tID0gJzgwcHgnO1xuICAgICAgICAgICAgICBhcnRpY2xlSW1hZ2Uuc3R5bGUud2lkdGggPSBhcnRpY2xlSW1hZ2Uub2Zmc2V0V2lkdGggKyAncHgnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgYXJ0aWNsZUltYWdlLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICAgICAgICAgICAgYXJ0aWNsZUltYWdlLnN0eWxlLnRvcCA9ICc0MHB4JztcbiAgICAgICAgICAgICAgYXJ0aWNsZUltYWdlLnN0eWxlLmJvdHRvbSA9ICdhdXRvJztcbiAgICAgICAgICAgICAgYXJ0aWNsZUltYWdlLnN0eWxlLndpZHRoID0gYXJ0aWNsZUltYWdlLm9mZnNldFdpZHRoICsgJ3B4JztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY3VycmVudFBhZ2VZUG9zaXRpb24gPSBwYWdlWU9mZnNldDtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXJ0aWNsZScpLnN0eWxlLnBhZGRpbmdMZWZ0ID0gJzE2cHgnO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIG5ldyBTdGFydFNjcmlwdHMoKTtcblxuICB3aW5kb3cub25yZXNpemUgPSBTdGFydFNjcmlwdHM7XG59KTtcblxuXG4vLyAvLyDQldGB0LvQuCDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0L3QsNC50LTQtdC9INC+0LTQuNC9INGN0LvQtdC80LXQvdGCXG4vLyBpZigoZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybVwiKSkgIT09IG51bGwpXG4vLyAgIGUuY2xhc3NMaXN0LmFkZCgnbGFzdCcpOyAvLyDQkNC90LDQu9C+0LMg0LLRi9Cx0L7RgNC60Lgg0Lgg0L/RgNC40YHQstC+0LXQvdC40Y8g0LrQu9Cw0YHRgdCwXG4vLyAvLyDQldGB0LvQuCDRjdC70LXQvNC10L3RgtC+0LIg0LHRg9C00LXRgiDQvNC90L7Qs9C+XG4vLyBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIjZm9ybVwiKSwgZnVuY3Rpb24oZSl7XG4vLyAgIGUuY2xhc3NMaXN0LmFkZCgnbGFzdCcpO1xuLy8gfSk7XG4iXX0=
